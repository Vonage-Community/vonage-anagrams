# Vonage Anagrams
A deployable application for running anagram-based giveaways. It utilizes the Messages API to message attendees when anagrams change, and uses the Number Insights API to format registration numbers.

## Installation

### Requirements
* Node 16 or higher
* PostgreSQL 13 or higher

### Render.com
You can deploy this application directly to [render.com](https://render.com). Just fill in some environmental information and it will deploy the web service and database.

[![Deploy to Render](https://render.com/images/deploy-to-render-button.svg)](https://render.com/deploy)

### Docker
You can run the web service as a Docker container. Build the container with:

    docker build . -t anagrams

You can then copy the `.env.dist` file to `.env` and add your configuration details. Note that the Vonage Private Key must be a base64 encoded version of the private key that is generated by the Vonage CLI or our dashboard. To generate a base64 encoded version, run:

    // Mac OS
    cat private.key | base64 -w 0

    // Linux/WSL
    cat private.key | base64

To run the service, call the `docker` command:

    docker run -d --name anagrams -p 3000:3000 --env-file .env anagrams

You will then need to run any needed [database migrations](#running-database-migrations).

### Manually

Install all the dependencies with:

    npm ci

You can then copy the `.env.dist` file to `.env` and add your configuration details. Note that the Vonage Private Key must be a base64 encoded version of the private key that is generated by the Vonage CLI or our dashboard. To generate a base64 encoded version, run:

    // Mac OS
    cat private.key | base64 -w 0

    // Linux/WSL
    cat private.key | base64

You can then run the application with node:

    // For production
    node index.js

    // For development
    npm run run-dev

You can then run any needed [database migrations](#running-database-migrations).

### Running Database Migrations
Database migrations are handled using [Sequelize](https://sequelize.org/). Once your `.env` file is configured, you can run the migrations locally using:

    npx sequelize db:migrate

There is currently no mechanism to run the migrations automatically.